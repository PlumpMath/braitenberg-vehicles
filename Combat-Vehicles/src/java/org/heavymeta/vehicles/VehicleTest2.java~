package org.heavymeta.vehicles;

import java.io.*;

import java.util.Date;

public class VehicleTest2 {


    public static void main(String argv[])
    throws com.ibm.jikes.skij.SchemeException
    {
	World w;
	if (argv.length != 1) {
	    System.err.println("usage: org.heavymeta.vehicles.VehicleTest2 <world file>");
	} else {
	    // Load the world
	    Log.info("Loading " + argv[0]);
	    try {
		w = World.load(new File(argv[0]));
	    }
	    catch (Exception e) {
		Log.error("Could not open the world file \"" + argv[0] + "\" [" + e + "]");
		return;
	    }
	    Log.info("\nRunning...");




	    VFrame f = new VFrame(VRenderer.class, w);
	    f.pack();
	    f.setSize(300,300);
	    f.show();
	    



	    Log.debug("Priming...");
	    for (int i = 0; i < 100; i++) {
		w.step(1,f.panel.renderer, f.panel.canvas.getGraphics());
	    }

	    Log.debug("Timing...");
	    long start, end;
	    start = (new Date()).getTime();
	    for (int i = 0; i < 100; i++) {
		w.step(1);
	    }
	    end = (new Date()).getTime();
	    Log.debug("100 world steps in " + (end - start) + " ms.");



	    while (true) {
		start = (new Date()).getTime();
		for (int i = 0; i < 50; i++) {
		    w.step(10,f.panel.renderer, f.panel.canvas.getGraphics());
		    
		}
		end = (new Date()).getTime();
		Log.debug("500 frames in " + (end - start) + " ms: " +
				   (1000.0 * (500.0 / (end - start))) + " fps");
	    }
	    
	    
	}

    }
}
